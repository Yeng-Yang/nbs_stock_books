<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML form to Google Sheet</title>
    <script type="text/javascript" src="jquery.min.js"></script>
</head>
<style>
    * {
        font-family: phetsarath ot;
        text-align: center;
    }

    .tex_Descriptoin {
        width: 100%;
        height: 50px;
        text-align: start;
    }

    h1 {
        text-align: center;
        background-color: aqua;
    }
    .Form_Entry{
        width: 100;
    }
</style>

<body>
    <h1 id="msg"><b><i><u>ບັນທຶກເງິນຖວາຍ</u></i></b></h1>
    <form class="Form_Entry">

        <label>ID ສະມາຊິກ</label><br>
        <input type="text" name="Menbers_ID" required placeholder='enter Menbers ID'>
        <br><br>
        <label>ຊື່ ແລະ ນາມສະກູນ</label><br>
        <input type="text" name="Name" required placeholder='enter Menbers Name'>
        <br><br>
        <label>ສິບລົດ</label><br>
        <input type="number" class="number" name="Tithe" required placeholder='enter tithe amount'>
        <br><br>
        <label>ທົວໄປ</label><br>
        <input type="number" class="number" name="Sbath" required placeholder='enter sbath amount'>
        <br><br>
        <label>ຖວາຍອື່ນໆ</label><br>
        <input type="number" class="number" name="Other" required placeholder='enter Other amount'>
        <br><br>
        <label>ລວມເງິນທັງໝົດ</label><br>
        <input type="text" id="total" name="Total"  disabled />
        <br><br>
        <label>ວັນທື</label><br>
        <input type="date" name="Date" required><br><br>

        <label>ເລກທີ</label><br>
        <input  type="text" name="Receipt_Number" required placeholder='enter Receipt_Number'><br><br>


        <center><input type="submit" id="sub" value="ບັນທຶກ"></center>

    </form>
    <hr>
<iframe src="Entry_history.html" width="100%" height="500px" frameborder="0"></iframe>
    <script>
        let form = document.querySelector("form");
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            document.querySelector("#sub").value = "ກຳລັງບັນທຶກໃສ່ Google Drive ຂອງທ່ານ...";
            let data = new FormData(form);
            fetch('https://script.google.com/macros/s/AKfycbzmtr6HCQQ8V9E1Rlu14twR1aEXEpuho5lJSp_WxZmJ6-WXHdfkXyHD7Q-8J6JgSDDtIw/exec', {
                method: "POST",
                body: data
            })
                .then(response => alert("ການບັນທຶກສຳເລັດຮຽບຮ້ອຍແລ້ວ", location.reload()))
                .catch(error => console.error('Error!', error.message))
        })
    </script>
</body>
<script>
    document.addEventListener('contextmenu', event => event.preventDefault()) 
</script>
<script>
	$('.number').keyup(function() {
     var sum = 0;
    $('.number').each(function() {
        sum += Number($(this).val());
    });
    $('.number').each(function() {
        sum += Number($(this).val());
    });
    $('#total').val(sum);
     
});
</script>
</html>